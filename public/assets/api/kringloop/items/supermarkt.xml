<qti-assessment-item
  xmlns="http://www.imsglobal.org/xsd/imsqtiasi_v3p0"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.imsglobal.org/xsd/imsqtiasi_v3p0 https://purl.imsglobal.org/spec/qti/v3p0/schema/xsd/imsqti_asiv3p0_v1p0.xsd"
  time-dependent="false"
  xml:lang="en"
  identifier="ITEM-SUPERMARKT"
  title="supermarkt"
  adaptive="true"
>

  <qti-response-declaration identifier="RSP-A-1" base-type="string" cardinality="single" />

  <qti-response-declaration identifier="RSP-B-1" base-type="string" cardinality="single">
    <qti-correct-response>
      <qti-value>C</qti-value>
    </qti-correct-response>
  </qti-response-declaration>

  <qti-response-declaration identifier="RSP-C" cardinality="multiple" base-type="directedPair">
    <qti-correct-response>
      <qti-value>PROD1 MARKB</qti-value>
      <qti-value>PROD2 MARKD</qti-value>
      <qti-value>PROD3 MARKE</qti-value>
    </qti-correct-response>
    <qti-mapping default-value="0">
      <qti-map-entry map-key="PROD1 MARKC" mapped-value="1" />
      <qti-map-entry map-key="PROD2 MARKA" mapped-value="1" />
      <qti-map-entry map-key="PROD3 MARKG" mapped-value="1" />
    </qti-mapping>
  </qti-response-declaration>

  <qti-outcome-declaration identifier="FBK-B" base-type="string" cardinality="single"></qti-outcome-declaration>
  <qti-outcome-declaration identifier="FBK-B-SHOW" base-type="string" cardinality="single"></qti-outcome-declaration>

  <qti-outcome-declaration identifier="FBK-C" base-type="string" cardinality="single"></qti-outcome-declaration>
  <qti-outcome-declaration identifier="FBK-C-SHOW" base-type="string" cardinality="single"></qti-outcome-declaration>


  <qti-outcome-declaration identifier="STEP" cardinality="multiple" base-type="integer">
    <qti-default-value>
      <qti-value>A</qti-value>
    </qti-default-value>
  </qti-outcome-declaration>

  <qti-outcome-declaration identifier="SCORE" cardinality="single" base-type="float">
    <qti-default-value>
      <qti-value>0</qti-value>
    </qti-default-value>
  </qti-outcome-declaration>

  <qti-stylesheet href="/css/supermarkt.css" type="text/css" />

  <qti-item-body>
    <!-- <p>SCORE:<qti-printed-variable class="qti-well"
    identifier="SCORE"></qti-printed-variable></p> -->

    <qti-feedback-block outcome-identifier="STEP" show-hide="show" identifier="A">
      <qti-content-body>
        <p>Ga de winkel in en pak een product dat je wel eens koopt. Kijk op de verpakking.</p>
        <strong>Welke
        van deze topkeurmerken staan er op vermeld?</strong>



        <qti-choice-interaction
          class="qti-choices-stacking-2" max-choices="0"
          response-identifier="RSP-A-1">
          <qti-simple-choice identifier="A"><img alt="" src="./images/Beter Leven.png" /></qti-simple-choice>
          <qti-simple-choice identifier="C"><img alt="" src="./images/Climate Neutral.png" /></qti-simple-choice>
          <qti-simple-choice identifier="E"><img alt="" src="./images/EKO.png" /></qti-simple-choice>
          <qti-simple-choice identifier="F"><img alt="" src="./images/EU-Biologisch.png" /></qti-simple-choice>
          <qti-simple-choice identifier="G"><img alt="" src="./images/Fartrade.png" /></qti-simple-choice>
          <qti-simple-choice identifier="H"><img alt="" src="./images/MSC.png" /></qti-simple-choice>
          <qti-simple-choice identifier="I"><img alt="" src="./images/Planet proof.png" /></qti-simple-choice>
          <qti-simple-choice identifier="J"><img alt="" src="./images/RSPO.png" /></qti-simple-choice>
          <qti-simple-choice identifier="K"><img alt="" src="./images/Rainforest Alliance.png" /></qti-simple-choice>
          <qti-simple-choice identifier="L"><img alt="" src="./images/SRP.png" /></qti-simple-choice>
          <qti-simple-choice identifier="M"><img alt="" src="./images/asc.png" /></qti-simple-choice>
          <qti-simple-choice identifier="M"><img alt="" src="./images/demeter.png" /></qti-simple-choice>
          <qti-simple-choice identifier="M">Geen keurmerk</qti-simple-choice>
        </qti-choice-interaction>
      </qti-content-body>
    </qti-feedback-block>

    <qti-feedback-block outcome-identifier="STEP" show-hide="show" identifier="B">
      <qti-content-body>
        <qti-choice-interaction
          response-identifier="RSP-B-1"
          class="qti-choices-left 
  qti-labels-decimal qti-labels-suffix-none"
          orientation="vertical">
          <qti-prompt>Wat is het doel van keurmerken op voedsel?</qti-prompt>
          <qti-simple-choice identifier="A">Zorgen dat de consument minder voedsel verspilt.</qti-simple-choice>
          <qti-simple-choice identifier="B">De verkoopprijs van producten verhogen. </qti-simple-choice>
          <qti-simple-choice identifier="C">Eisen stellen aan het welzijn van mens, dier en milieu.</qti-simple-choice>
          <qti-simple-choice identifier="D">Bekendheid van de producenten van het product vergroten.</qti-simple-choice>
        </qti-choice-interaction>

        <qti-feedback-inline
          outcome-identifier="FBK-B" show-hide="show" identifier="CORRECT">üëç Dat klopt.</qti-feedback-inline>
      <qti-feedback-inline
          outcome-identifier="FBK-B" show-hide="show" identifier="INCORRECT">üòî</qti-feedback-inline>
      <qti-feedback-inline
          outcome-identifier="FBK-B-SHOW" show-hide="show" identifier="SHOW">Door een product met
        een (top)keurmerk te kopen zorg je voor betere omstandigheden voor mens, dier en milieu.</qti-feedback-inline>
      </qti-content-body>

    </qti-feedback-block>

    <qti-feedback-block outcome-identifier="STEP" show-hide="show" identifier="C">
      <qti-content-body>
        <strong>Wat betekenen de keurmerken?</strong>
        <p>Plak het juiste keurmerk op het product. Er
        blijven 3 keurmerken over.</p>

        <qti-match-interaction
          max-associations="4"
          response-identifier="RSP-C">
          <qti-simple-match-set>


            <qti-simple-associable-choice identifier="MARKA" match-max="2"><img alt=""
                src="./images/asc.png" /></qti-simple-associable-choice>
            <qti-simple-associable-choice identifier="MARKB" match-max="2"><img alt=""
                src="./images/EU-Biologisch.png" /></qti-simple-associable-choice>
            <qti-simple-associable-choice identifier="MARKC" match-max="2"><img alt=""
                src="./images/Rainforest Alliance.png" /></qti-simple-associable-choice>
            <qti-simple-associable-choice identifier="MARKD" match-max="2"><img alt=""
                src="./images/MSC.png" /></qti-simple-associable-choice>
            <qti-simple-associable-choice identifier="MARKE" match-max="2"><img alt=""
                src="./images/Planet proof.png" /></qti-simple-associable-choice>
            <qti-simple-associable-choice identifier="MARKF" match-max="2"><img alt=""
                src="./images/Fartrade.png" /></qti-simple-associable-choice>


          </qti-simple-match-set>
          <qti-simple-match-set>
            <qti-simple-associable-choice identifier="PROD1" match-max="1">Kipfilet: biologisch</qti-simple-associable-choice>
            <qti-simple-associable-choice identifier="PROD2" match-max="1"> Wilde zalmfilets:
        verantwoord gevangen zonder overbevissing </qti-simple-associable-choice>
            <qti-simple-associable-choice identifier="PROD3" match-max="1"> Halfvolle melk: duurzaam
        geproduceerd </qti-simple-associable-choice>
          </qti-simple-match-set>
        </qti-match-interaction>

        <qti-feedback-inline
          outcome-identifier="FBK-C" show-hide="show" identifier="CORRECT">üëç Goedzo.</qti-feedback-inline>
        <qti-feedback-inline
          outcome-identifier="FBK-C" show-hide="show" identifier="INCORRECT">üòî Helaas.</qti-feedback-inline>

          <qti-feedback-inline
          outcome-identifier="FBK-C-SHOW" show-hide="show" identifier="SHOW">Wist je dat er zo'n 150
        voedingsbeeldmerken zijn?! Daarvan zijn 12 topkeurmerken geselecteerd die voldoen aan hoge
        eisen op ambitie, transparantie en betrouwbaarheid. Als je die 12 kent dan kom je een heel
        eind bij het maken van betere keuzes in de supermarkt.</qti-feedback-inline>


      </qti-content-body>
    </qti-feedback-block>


  </qti-item-body>

  <qti-response-processing>
    <qti-set-outcome-value identifier="STEP">
      <qti-custom-operator class="js.org">
        <qti-base-value base-type="string"><![CDATA[
        if (item.getVariable('RSP-A-1').value?.length > 0 && !item.getVariable('STEP').value.includes('B')) {
          item.updateOutcomeVariable('STEP', 'B');
        }
        if (
          item.getVariable('RSP-B-1')?.value?.length > 0
           && !item.getVariable('STEP').value.includes('C')
        ) {
          if (item.getVariable('RSP-B-1').value === item.getVariable('RSP-B-1').correctResponse) {
            const score = !item.getVariable('FBK-B').value ? 1 : 0
            item.updateOutcomeVariable('SCORE', score);
            item.updateOutcomeVariable('FBK-B', 'CORRECT');
            item.updateOutcomeVariable('STEP', 'C');
          } else {
            item.updateOutcomeVariable('FBK-B', 'INCORRECT');
            item.updateOutcomeVariable('FBK-B-SHOW', 'SHOW');
          }
        }     
        if (item.getVariable('STEP').value.includes('C') && !item.getVariable('STEP').value.includes('D')
        ) {
          const distinctRows = item.getVariable('RSP-C').value?.map(res => res.split(" ")[0]);
          let uniqueItems = [...new Set(distinctRows)]

          if (uniqueItems.length === item.getVariable('RSP-C').correctResponse.length) {
            valueString = item.getVariable('RSP-C').value.join(" ");
            correctString = item.getVariable('RSP-C').correctResponse.join(" ");
            if (valueString === correctString) {
              item.updateOutcomeVariable('SCORE',+item.getVariable('SCORE').value + 1);
              item.updateOutcomeVariable('FBK-C', 'CORRECT');
            } else {
              item.updateOutcomeVariable('FBK-C', 'INCORRECT');
            }
            item.updateOutcomeVariable('FBK-C-SHOW', 'SHOW');
            item.updateOutcomeVariable('STEP', 'D');
          }
        }

        if (item.getVariable('STEP').value.includes('D')
        ) {
          item.updateOutcomeVariable('completionStatus', 'completed'); 
        }

        ]]></qti-base-value>
      </qti-custom-operator>
    </qti-set-outcome-value>
  </qti-response-processing>
</qti-assessment-item>