<qti-assessment-item
  xmlns="http://www.imsglobal.org/xsd/imsqtiasi_v3p0"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.imsglobal.org/xsd/imsqtiasi_v3p0 https://purl.imsglobal.org/spec/qti/v3p0/schema/xsd/imsqti_asiv3p0_v1p0.xsd"
  time-dependent="false"
  xml:lang="en"
  identifier="ITEM-AFVALBAK"
  title="afvalbak"
  adaptive="true"
>

  <qti-response-declaration identifier="RSP-A-1" base-type="string" cardinality="single" />
  <qti-response-declaration identifier="RSP-A-2" base-type="string" cardinality="single" />

  <qti-response-declaration identifier="RSP-B-1" base-type="string" cardinality="single">
    <qti-correct-response>
      <qti-value>A</qti-value>
    </qti-correct-response>
  </qti-response-declaration>

  <qti-response-declaration identifier="RSP-C" cardinality="multiple" base-type="directedPair">
    <qti-correct-response>
      <qti-value>PROD1 BINC</qti-value>
      <qti-value>PROD2 BINA</qti-value>
      <qti-value>PROD3 BINE</qti-value>
      <qti-value>PROD4 BINE</qti-value>
      <qti-value>PROD5 BIND</qti-value>
    </qti-correct-response>
    <qti-mapping default-value="0">
      <qti-map-entry map-key="PROD1 BINC" mapped-value="1" />
      <qti-map-entry map-key="PROD2 BINA" mapped-value="1" />
      <qti-map-entry map-key="PROD3 BING" mapped-value="1" />
      <qti-map-entry map-key="PROD4 BING" mapped-value="1" />
      <qti-map-entry map-key="PROD5 BINE" mapped-value="1" />
    </qti-mapping>
  </qti-response-declaration>

  <qti-outcome-declaration identifier="FBK-B" base-type="string" cardinality="single" />
  <qti-outcome-declaration identifier="FBK-B-SHOW" base-type="string" cardinality="single" />

  <qti-outcome-declaration identifier="FBK-C" base-type="string" cardinality="single"></qti-outcome-declaration>
  <qti-outcome-declaration identifier="FBK-C-SHOW" base-type="string" cardinality="single"></qti-outcome-declaration>

  <qti-outcome-declaration identifier="STEP" cardinality="multiple" base-type="integer">
    <qti-default-value>
      <qti-value>A</qti-value>
    </qti-default-value>
  </qti-outcome-declaration>

  <qti-outcome-declaration identifier="SCORE" cardinality="single" base-type="float">
    <qti-default-value>
      <qti-value>0</qti-value>
    </qti-default-value>
  </qti-outcome-declaration>

  <qti-stylesheet href="/css/afvalbak.css" type="text/css" />


  <qti-item-body>
    <!-- <p>SCORE:<qti-printed-variable class="qti-well"
    identifier="SCORE"></qti-printed-variable></p> -->

    <qti-feedback-block outcome-identifier="STEP" show-hide="show" identifier="A">
      <qti-content-body>
        <strong>Wordt bij deze afvalbak afval gescheiden?</strong>
        <qti-choice-interaction
          response-identifier="RSP-A-1">
          <qti-simple-choice identifier="A">Ja</qti-simple-choice>
          <qti-simple-choice identifier="B">Nee</qti-simple-choice>
        </qti-choice-interaction>
        <p>Welk
        afval wordt hier weggegooid?</p>
        <qti-choice-interaction
          response-identifier="RSP-A-2" max-choices="0">
          <qti-simple-choice identifier="A">Plastic</qti-simple-choice>
          <qti-simple-choice identifier="B">Papier</qti-simple-choice>
          <qti-simple-choice identifier="C">GFT</qti-simple-choice>
          <qti-simple-choice identifier="D">Textiel</qti-simple-choice>
          <qti-simple-choice identifier="E">Restafval</qti-simple-choice>
          <qti-simple-choice identifier="F">Glas</qti-simple-choice>
        </qti-choice-interaction>
      </qti-content-body>
    </qti-feedback-block>

    <qti-feedback-block outcome-identifier="STEP" show-hide="show" identifier="B">
      <qti-content-body>
        <qti-choice-interaction
          response-identifier="RSP-B-1"
          class="qti-choices-left 
  qti-labels-decimal qti-labels-suffix-none"
          orientation="vertical">
          <qti-prompt>Waarom is afval scheiden belangrijk?</qti-prompt>
          <qti-simple-choice identifier="A">Omdat er waardevolle materialen in het afval zitten die
        hergebruikt kunnen worden als ze gescheiden worden.</qti-simple-choice>
          <qti-simple-choice identifier="B">Omdat de gemeente verdient aan afvalscheiding waardoor
        het beter is voor de economie.</qti-simple-choice>
          <qti-simple-choice identifier="C">Omdat het meer ritjes oplevert voor de afvalinzamelaars
        en daardoor meer banen creëert.</qti-simple-choice>
          <qti-simple-choice identifier="D">Omdat al het afval bij elkaar gooien schadelijk is voor
        de gezondheid van mens en dier.</qti-simple-choice>
        </qti-choice-interaction>

        <qti-feedback-inline
          outcome-identifier="FBK-B" show-hide="show" identifier="CORRECT">👍 Juist!</qti-feedback-inline>
      <qti-feedback-inline
          outcome-identifier="FBK-B" show-hide="show" identifier="INCORRECT">😔 Probeer het nog
        eens.</qti-feedback-inline>
      <qti-feedback-inline
          outcome-identifier="FBK-B-SHOW" show-hide="show" identifier="SHOW">Afval scheiden zorgt
        ervoor dat we kunnen recyclen. Dit betekent dat we het afval opnieuw als grondstof kunnen
        gebruiken voor nieuwe spullen.</qti-feedback-inline>


      </qti-content-body>
    </qti-feedback-block>

    <qti-feedback-block outcome-identifier="STEP" show-hide="show" identifier="C">
      <qti-content-body>

        <p><strong>In welke afvalbak gooi je de volgende producten? </strong></p>
        <qti-match-interaction
          class="qti-match-tabular" max-associations="4"
          response-identifier="RSP-C">
          <qti-simple-match-set>
            <qti-simple-associable-choice identifier="PROD1" match-max="1">Banaan</qti-simple-associable-choice>
            <qti-simple-associable-choice identifier="PROD2" match-max="1">Chipszak</qti-simple-associable-choice>
            <qti-simple-associable-choice identifier="PROD3" match-max="1">Blikje</qti-simple-associable-choice>
            <qti-simple-associable-choice identifier="PROD4" match-max="1">Batterij</qti-simple-associable-choice>
            <qti-simple-associable-choice identifier="PROD5" match-max="1">Balpen</qti-simple-associable-choice>
          </qti-simple-match-set>
          <qti-simple-match-set>
            <qti-simple-associable-choice identifier="BINA" match-max="2">Plastic</qti-simple-associable-choice>
            <qti-simple-associable-choice identifier="BINB" match-max="2">Papier</qti-simple-associable-choice>
            <qti-simple-associable-choice identifier="BINC" match-max="2">GFT</qti-simple-associable-choice>
            <qti-simple-associable-choice identifier="BIND" match-max="2">Rest</qti-simple-associable-choice>
            <qti-simple-associable-choice identifier="BINE" match-max="2">Anders</qti-simple-associable-choice>
          </qti-simple-match-set>
        </qti-match-interaction>

        <qti-feedback-inline
          outcome-identifier="FBK-C" show-hide="show" identifier="CORRECT">👍 Top, al het afval zit
        in de juiste bak!</qti-feedback-inline>
      <qti-feedback-inline
          outcome-identifier="FBK-C" show-hide="show" identifier="INCORRECT">😔 Jammer niet al het
        afval zit in de juiste bak.</qti-feedback-inline>

        <qti-feedback-inline
          outcome-identifier="FBK-C-SHOW" show-hide="show" identifier="SHOW"> Wist je dat gescheiden
        afval alleen opnieuw gebruikt kan worden als er niet teveel dingen bij zitten die er niet
        bij horen? Papier kunnen we niet recyclen als er plastic tussen zit. Maar ook een pizzadoos
        met veel vetvlekken en voedselresten mag niet bij het oud papier belanden. Als er te veel
        afval door elkaar zit belandt het in de verbrandingsoven.</qti-feedback-inline>

      </qti-content-body>
    </qti-feedback-block>


  </qti-item-body>

  <qti-response-processing>
    <qti-set-outcome-value identifier="STEP">
      <qti-custom-operator class="js.org">
        <qti-base-value base-type="string"><![CDATA[
        if (item.getVariable('RSP-A-1').value !== null && !item.getVariable('STEP').value.includes('B')) {
          item.updateOutcomeVariable('STEP', 'B');
        }

        if (
          item.getVariable('RSP-B-1').value !== null &&
          !item.getVariable('STEP').value.includes('C')
        ) {
          if (item.getVariable('RSP-B-1').value === item.getVariable('RSP-B-1').correctResponse) {
            const score = !item.getVariable('FBK-B').value ? 1 : 0
            item.updateOutcomeVariable('SCORE', score);
            item.updateOutcomeVariable('FBK-B', 'CORRECT');
            item.updateOutcomeVariable('STEP', 'C');
          } else {
            item.updateOutcomeVariable('FBK-B', 'INCORRECT');
            item.updateOutcomeVariable('FBK-B-SHOW', 'SHOW');
          }
        }
        
        if (item.getVariable('STEP').value.includes('C') && !item.getVariable('STEP').value.includes('D')
        ) {
          const distinctRows = item.getVariable('RSP-C').value?.map(res => res.split(" ")[0]);
          let uniqueItems = [...new Set(distinctRows)]
          if (uniqueItems.length === item.getVariable('RSP-C').correctResponse.length) {
            valueString = item.getVariable('RSP-C').value.join(" ");
            correctString = item.getVariable('RSP-C').correctResponse.join(" ");
            if (valueString === correctString) {
              item.updateOutcomeVariable('SCORE', item.getVariable('SCORE').value + 1);
              item.updateOutcomeVariable('FBK-C', 'CORRECT');
            } else {
              item.updateOutcomeVariable('FBK-C', 'INCORRECT');
            }
            item.updateOutcomeVariable('FBK-C-SHOW', 'SHOW');
            item.updateOutcomeVariable('STEP', 'D');
          }
          
        }

        if (item.getVariable('STEP').value.includes('D')
        ) {
          item.updateOutcomeVariable('completionStatus', 'completed'); 
        }
        ]]></qti-base-value>
      </qti-custom-operator>
    </qti-set-outcome-value>
  </qti-response-processing>
</qti-assessment-item>